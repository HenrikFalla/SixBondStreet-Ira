{% comment %}
  Pass these variables into snippet:
  * image: Image object
  * sizes: srcset size attribute
  * prioritizeLoading: is this image rendered above the fold or otherwise priotized? this will avoid loading="lazy"
{% endcomment %}

{% if tagName == blank %}
  {% assign tagName = "img" %}
{% endif %}

{% if baseSize == blank %}
  {% assign baseSize = "320x" %}
{% endif %}

{% if lazy %}
  {% assign srcAttr = "data-src" %}
  {% assign srcSetAttr = "data-srcset" %}
{% else %}
  {% assign srcAttr = "src" %}
  {% assign srcSetAttr = "srcset" %}
{% endif %}

{% unless prioritizeLoading %}
  {% assign browserLazyString = 'loading="lazy"' %}
{% endunless %}

<{{tagName}} 
  alt="{{ image.alt | escape }}" 
  class="image__img {% if className %}{{className}}{% endif %}"
  {% unless prioritizeLoading %}
  loading="lazy"
  {% endunless %}
  width={{image.width}}
  height={{image.height}}
  {% unless tagName == "source" %}{{srcAttr}}="{{ image | img_url: baseSize }}"{% endunless %}
  {% if media %}media="{{media}}"{% endif %}
  {{srcSetAttr}}="{{ image | img_url: '200x', format: 'jpg' }} 200w,
                  {{ image | img_url: '240x', format: 'jpg' }} 240w,
                  {{ image | img_url: '280x', format: 'jpg' }} 280w,
                  {{ image | img_url: '300x', format: 'jpg' }} 300w,
                  {{ image | img_url: '360x', format: 'jpg' }} 360w,
                  {{ image | img_url: '400x', format: 'jpg' }} 400w,
                  {{ image | img_url: '450x', format: 'jpg' }} 450w,
                  {{ image | img_url: '500x', format: 'jpg' }} 500w,
                  {{ image | img_url: '550x', format: 'jpg' }} 550w,
                  {{ image | img_url: '600x', format: 'jpg' }} 600w,
                  {{ image | img_url: '650x', format: 'jpg' }} 650w,
                  {{ image | img_url: '700x', format: 'jpg' }} 700w,
                  {{ image | img_url: '750x', format: 'jpg' }} 750w,
                  {{ image | img_url: '800x', format: 'jpg' }} 800w,
                  {{ image | img_url: '850x', format: 'jpg' }} 850w,
                  {{ image | img_url: '900x', format: 'jpg' }} 900w,
                  {{ image | img_url: '950x', format: 'jpg' }} 950w,
                  {{ image | img_url: '1000x', format: 'jpg' }} 1000w
{% if image.width > 1000 %}, {{ image | img_url: '1100x', format: 'jpg' }} 1100w {% endif %}
{% if image.width > 1100 %}, {{ image | img_url: '1200x', format: 'jpg' }} 1200w {% endif %}
{% if image.width > 1200 %}, {{ image | img_url: '1300x', format: 'jpg' }} 1300w {% endif %}
{% if image.width > 1300 %}, {{ image | img_url: '1400x', format: 'jpg' }} 1400w {% endif %}
{% if image.width > 1400 %}, {{ image | img_url: '1500x', format: 'jpg' }} 1500w {% endif %}
{% if image.width > 1500 %}, {{ image | img_url: '1600x', format: 'jpg' }} 1600w {% endif %}
{% if image.width > 1600 %}, {{ image | img_url: '1800x', format: 'jpg' }} 1800w {% endif %}
{% if image.width > 1800 %}, {{ image | img_url: '2000x', format: 'jpg' }} 2000w {% endif %}
{% if image.width > 2000 %}, {{ image | img_url: '2200x', format: 'jpg' }} 2200w {% endif %}
{% if image.width > 2200 %}, {{ image | img_url: '2400x', format: 'jpg' }} 2400w {% endif %}
{% if image.width > 2400 %}, {{ image | img_url: '2600x', format: 'jpg' }} 2600w {% endif %}
{% if image.width > 2600 %}, {{ image | img_url: '2800x', format: 'jpg' }} 2800w {% endif %}
{% if image.width > 2800 %}, {{ image | img_url: '3000x', format: 'jpg' }} 3000w {% endif %}
{% if image.width > 2000 %}, {{ image | img_url: '3200x', format: 'jpg' }} 3200w {% endif %}"
     sizes="{{sizes}}" />